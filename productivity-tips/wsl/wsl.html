<!doctype html>
<html lang="en">
  <head>
		<!-- Required meta tags -->
    <meta charset="utf-8">
    
    <!-- Bootstrap CSS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
		
		<link rel="stylesheet" href="../../style.css">
    
    <title>WSL</title>
  </head>

  <body>
		<div class="container text-justify my-5" style="max-width: 800px;">
			
			<nav aria-label="breadcrumb">
        <ol class="breadcrumb">
					<li class="breadcrumb-item"><a href="../../">Home</a></li>
					<li class="breadcrumb-item"><a href="../">Productivity Tips</a></li>
          <li class="breadcrumb-item active" aria-current="page">WSL</li>
        </ol>
			</nav>
			
			<h1 class="display-4">Windows Subsystem for Linux</h1>
			<p class="lead">
				This guide will walk you through the installation and setup of Windows Subsystem for Linux (WSL) on your Windows machine, which will give you access to Linux tools on Windows. This will enable you to compile and test your lab and assignment code on your local machine as if you were working on VLAB or the CSE lab machines.
			</p>

			<div class="alert alert-warning">
				<b>Warning:</b> Note that testing your code on your local machine should not replace testing your code on the CSE system. In the end, your assignments will be autotested on the CSE system, so you should test your code regularly on the CSE machines to avoid any last-minute issues.
			</div>
      
			<!-------------------------- Contents --------------------------->
			
			<h4>In this guide:</h4>
			<ul style="list-style-type: none; padding-left: 0px;">
				<li><a href="#part-1">Part 1: Installing WSL</a></li>
				<li><a href="#part-2">Part 2: Navigating the WSL File System</a></li>
				<li><a href="#part-3">Part 3: WSL and VSCode</a></li>
			</ul>

			<!--------------------- -- Prerequisites ------------------------>

			<h4>Prerequisites:</h4>
			<p>None</p>

			<!--------------------------- Part 1 ---------------------------->

			<h2 id="part-1">Part 1: Installing WSL</h2>
			<p class="lead">
				In this part, you will install and set up WSL on your Windows machine. You will also compile and run a simple C program on the WSL command prompt.
			</p>

			<p>
				To help you better understand how WSL works, here is a diagram of the WSL file system:
			</p>

			<img class="mb-4" src="assets/wsl-1.png">

			<p>
				As shown in the diagram, the WSL file system is built on top of the Windows file system. (The technical phrase is that the WSL file system <i>mounts</i> the Windows file system.) This gives the WSL command prompt access to files on the 'Windows side' in addition to the Linux tools on the 'Linux side', which allows you to run Linux tools on code situated on the Windows side.
			</p>

			<h3>Installation and Setup</h3>

			<p>
				There is a guide on how to set up and install WSL on the <a href="https://docs.microsoft.com/en-us/windows/wsl/about" target="_blank">Microsoft website</a>. The sections you should follow are <b>Install on Windows 10</b> and <b>Initialize Distro</b>. I recommend getting the Ubuntu distribution from the Microsoft Store.
			</p>

			<p>
				Here are some screenshots from the setup process to help you ensure that you are on the right track:
			</p>

			<div id="wsl-setup-carousel" class="carousel slide" data-interval="false">
				<div class="carousel-inner">
					<div class="carousel-item active">
						<img class="d-block w-100" src="assets/wsl-2.png">
						<div class="carousel-caption d-none d-md-block">
							<p>1. After clicking <b>Launch</b> in the Microsoft Store app page</p>
						</div>
					</div>
					<div class="carousel-item">
						<img class="d-block w-100" src="assets/wsl-3.png">
						<div class="carousel-caption d-none d-md-block">
							<p>2. After setting a username and password for the Linux user account</p>
						</div>
					</div>
					<div class="carousel-item">
						<img class="d-block w-100" src="assets/wsl-4.png">
						<div class="carousel-caption d-none d-md-block">
							<p>3. After running <code>sudo apt update && sudo apt upgrade</code></p>
						</div>
					</div>
					<div class="carousel-item">
						<img class="d-block w-100" src="assets/wsl-5.png">
						<div class="carousel-caption d-none d-md-block">
							<p>4. After entering <b>Y</b> to continue and waiting</p>
						</div>
					</div>
					<div class="carousel-item">
						<img class="d-block w-100" src="assets/wsl-6.png">
						<div class="carousel-caption d-none d-md-block">
							<p>5. After selecting <b>&lt;No&gt;</b></p>
						</div>
					</div>
					<div class="carousel-item">
						<img class="d-block w-100" src="assets/wsl-7.png">
						<div class="carousel-caption d-none d-md-block">
							<p>6. After selecting <b>&lt;Ok&gt;</b> and waiting</p>
						</div>
					</div>
				</div>
				<a class="carousel-control-prev" href="#wsl-setup-carousel" role="button" data-slide="prev">
					<span class="carousel-control-prev-icon" aria-hidden="true"></span>
					<span class="sr-only">Previous</span>
				</a>
				<a class="carousel-control-next" href="#wsl-setup-carousel" role="button" data-slide="next">
					<span class="carousel-control-next-icon" aria-hidden="true"></span>
					<span class="sr-only">Next</span>
				</a>
			</div>

			<h3>Compiling a C program on WSL</h3>

			<div class="mt-3 alert alert-primary">
				The section below involves writing a program in VIM, a text editor. Don't worry if you haven't used VIM or don't intend to learn VIM - you'll only need to use it once throughout this guide.
			</div>
			<p>
				Now that you've installed WSL, let's try to compile a simple program on it. First, use the command <code>vim helloWorld.c</code> to open a file called <code>helloWorld.c</code> in VIM. Then, press <kbd>I</kbd> to enter insertion mode, and insert the following code:
			</p>

			<pre class="code-block"><code>
#include &lt;stdio.h&gt;
				
int main(void) {
	printf("Hello, World!\n");
}
			</code></pre>

			<p>
				When you are done, press <kbd>Esc</kbd> to leave insertion mode, and then type <code>:wq</code> (followed by pressing enter) to <b>w</b>rite to the file (i.e., save the file) and <b>q</b>uit.
			</p>

			<p>Now, it's time to compile the program. In COMP2521, you'll be using <code>gcc</code> rather than <code>dcc</code> to compile your programs. The compilation command is:</p>

			<pre class="terminal-window"><code>
$ gcc -Wall -Werror -std=c11 -o helloWorld helloWorld.c
			</code></pre>

			<p>
				At the moment, this won't work, as <code>gcc</code> is not yet installed on WSL. Instead, you'll get a message telling you to install <code>gcc</code>. Follow the instructions to install it and then try again. (Later on, you'll need to install other programs such as <code>gdb</code> and <code>make</code>.)
			</p>

			<pre class="terminal-window"><code>
$ sudo apt install gcc
...
$ gcc -Wall -Werror -std=c11 -o helloWorld helloWorld.c
$ ./helloWorld
Hello, World!
$
			</code></pre>

			<p>
				If you've made it this far, congratulations! You've successfully installed WSL and used it to compile and run a simple C program.
			</p>

			<!--------------------------- Part 2 ---------------------------->

			<h2 id="part-2">Part 2: Navigating the WSL File System</h2>

			<p class="lead">
				In this part, you will learn some tips and tricks for navigating around the WSL file system.
			</p>

			<!-- <p>
				WSL provides a Linux environment, which means that you can use the same commands that you have been using in the terminal on VLAB and the CSE lab machines, such as <code>cd</code> to change directories and <code>ls</code> to list files.
			</p> -->

			<p>
				In the diagram of the WSL file system in the previous section, you saw that it is possible for the WSL command prompt to access files on the Windows side. But so far, we've been working entirely on the Linux side - the Hello World program was written and compiled in our Linux home directory. Now, we will use WSL to compile and run code on the Windows side.
			</p>

			<p>
				Suppose that your COMP2521 code is stored on the path <code>C:\Users\YourName\Documents\comp2521</code> within the Windows file system. You want to compile and test it, so you start up the WSL command prompt, which opens to your Linux home directory.
			</p>
			
			<pre class="terminal-window"><code>
$ pwd         # prints the current working directory
/home/user1   # your username is probably *not* user1, so you'll see something different
			</code></pre>
			
			<p>
				So how can you navigate to your code? The diagram below shows the current situation.
			</p>

			<img src="assets/wsl-8.png">

			<p>
				Since the Windows path is <code>C:\Users\YourName\Documents\comp2521</code>, the corresponding Linux path is <code>/mnt/c/Users/YourName/Documents/comp2521</code>. So the command to navigate to your COMP2521 directory is:
			</p>

			<pre class="terminal-window"><code>
$ cd /mnt/c/Users/YourName/Documents/comp2521
			</code></pre>

			<p>
				Great! Now we can compile and run our code just like on VLAB or the CSE machines.
			</p>

			<pre class="terminal-window"><code>
$ cd lab01
$ make
...
$ ./useIntList
...
			</code></pre>

			<p>
				So now you know how to navigate to files on the Windows side. This is all well and good, but you still have to type that long pathname whenever you open the WSL command prompt. How can we get rid of this mild annoyance?
			</p>

			<p>
				<b>Answer: symlinks!</b>
			</p>

			<p>
				A symlink is like a shortcut in Windows. We're going to create a shortcut from your Linux home directory to your COMP2521 directory. The command for creating a symlink in Linux is <code>ln -s &lt;target path&gt; &lt;link name&gt;</code>. In this example, the target path (i.e., the pathname of your COMP2521 directory) is <code>/mnt/c/Users/YourName/Documents/comp2521</code>. The link name be anything, but it makes sense to call it <code>comp2521</code>. Thus, the full command is:
			</p>

			<pre class="terminal-window"><code>
$ cd    # go back to the home directory
$ ln -s /mnt/c/Users/YourName/Documents/comp2521 comp2521
			</code></pre>

			<p>
				Now, when you use the <code>ls</code> command, you should see the <code>comp2521</code> symlink you've just made, and doing <code>cd comp2521</code> should take you directly to the directory containing your COMP2521 code. Hooray!
			</p>

			<pre class="terminal-window"><code>
$ ls
comp2521  helloWorld  helloWorld.c
$ cd comp2521
$ cd lab01   # we could have done cd comp2521/lab01 instead of cd'ing twice
$ make
...
$ ./useIntList
...
			</code></pre>

			<p>
				Congratulations! Now, you've learned how to navigate to files on the Windows side and create symlinks to them on WSL.
			</p>

			<!--------------------------- Part 3 ---------------------------->

			<h2 id="part-3">Part 3: WSL and VSCode</h2>
			<p>
				Thanks to VSCode's integrated terminal and <b>Remote - WSL</b> extension, you can open the WSL command prompt in VSCode itself, which should greatly boost your productivity as you won't have to repeatedly switch back and forth between your code editor and terminal window. Here's what it looks like:
			</p>

			<img src="assets/wsl-9.png">

			<p>Neat, eh?</p>

			<p>
				This is just one of the many great things about VSCode, and I strongly recommend that you use it for coding in COMP2521. You can learn more about VSCode <a href="../vscode/">here</a>.
			</p>

			<p>
				That's all for this guide. Thanks for reading!
			</p>

    </div>
    
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  </body>
</html>
